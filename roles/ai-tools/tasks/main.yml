---
- name: Check if claude is installed
  ansible.builtin.command: which claude
  register: claude_check
  changed_when: false
  failed_when: false

- name: Install Claude Code
  ansible.builtin.shell: curl -fsSL https://claude.ai/install.sh | bash
  when: claude_check.rc != 0

- name: Check if codex is installed
  ansible.builtin.shell: "{{ dotfiles_home }}/.local/bin/mise exec -- which codex"
  register: codex_check
  changed_when: false
  failed_when: false

- name: Install ChatGPT Codex
  ansible.builtin.command: "{{ dotfiles_home }}/.local/bin/mise exec -- npm install -g @openai/codex"
  environment:
    PATH: "{{ dotfiles_home }}/.local/bin:{{ ansible_env.PATH }}"
  when: codex_check.rc != 0
