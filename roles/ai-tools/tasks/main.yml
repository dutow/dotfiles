---
- name: Check if claude is installed
  ansible.builtin.command: which claude
  register: claude_check
  changed_when: false
  failed_when: false

- name: Install Claude Code
  ansible.builtin.shell: curl -fsSL https://claude.ai/install.sh | bash
  when: claude_check.rc != 0

- name: Check if npm is available
  ansible.builtin.command: which npm
  register: npm_check
  changed_when: false
  failed_when: false

- name: Check if codex is installed
  ansible.builtin.command: which codex
  register: codex_check
  changed_when: false
  failed_when: false
  when: npm_check.rc == 0

- name: Install ChatGPT Codex
  ansible.builtin.command: npm install -g @openai/codex
  become: true
  when:
    - npm_check.rc == 0
    - codex_check.rc is defined
    - codex_check.rc != 0
